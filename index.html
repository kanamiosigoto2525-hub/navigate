<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒˆãƒ©ãƒƒã‚¯é‹è»¢æ‰‹æ”¯æ´ã‚¢ãƒ—ãƒª(è©¦ä½œ)</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; background: #f0f0f0; }
        h2 { text-align: center; color: #333; }
        
        /* å·¨å¤§ãªãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .btn {
            display: block; width: 100%; padding: 30px; margin-bottom: 20px;
            font-size: 24px; font-weight: bold; border: none; border-radius: 15px;
            cursor: pointer; text-align: center;
        }
        .btn-record { background: #ffcc00; color: #000; } /* è¨˜éŒ²é–‹å§‹/åœæ­¢ */
        .btn-voice { background: #ff4444; color: #fff; }  /* éŸ³å£°ãƒ¡ãƒ¢ */
        .btn-save { background: #228b22; color: #fff; }   /* ä¿å­˜ */

        /* å…¥åŠ›ã‚¨ãƒªã‚¢ */
        textarea {
            width: 100%; height: 120px; font-size: 20px;
            margin-bottom: 10px; border-radius: 10px; border: 2px solid #ccc;
            box-sizing: border-box; padding: 10px;
        }

        #status { font-weight: bold; color: blue; text-align: center; margin-bottom: 10px; }
        #log { background: #fff; padding: 10px; border-radius: 10px; font-size: 14px; }
    </style>
</head>
<body>

    <h2>ãƒ«ãƒ¼ãƒˆè¨˜éŒ²ã‚¢ãƒ—ãƒª</h2>
    <div id="status">å¾…æ©Ÿä¸­</div>

    <button id="recordBtn" class="btn btn-record" onclick="toggleRecord()">ãƒ«ãƒ¼ãƒˆè¨˜éŒ²é–‹å§‹</button>

    <hr>

    <p>åœ°ç‚¹ãƒ¡ãƒ¢ï¼ˆæ–‡å­—å…¥åŠ›ã‚‚å¯ï¼‰</p>
    <textarea id="memoText" placeholder="ã“ã“ã«ãƒ¡ãƒ¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™..."></textarea>

    <button id="voiceBtn" class="btn btn-voice" onclick="startVoice()">ğŸ¤ å£°ã§ãƒ¡ãƒ¢ã‚’å…¥ã‚Œã‚‹</button>

    <button class="btn btn-save" onclick="saveMemo()">ã“ã®åœ°ç‚¹ã‚’ä¿å­˜</button>

    <div id="log">ã€è¨˜éŒ²ãƒ­ã‚°ã€‘</div>

    <script>
        let isRecording = false;
        let watchId = null;

        // --- ãƒ«ãƒ¼ãƒˆè¨˜éŒ²ã®åˆ‡ã‚Šæ›¿ãˆ ---
        function toggleRecord() {
            const btn = document.getElementById('recordBtn');
            const status = document.getElementById('status');
            
            if (!isRecording) {
                isRecording = true;
                btn.innerText = "è¨˜éŒ²åœæ­¢";
                btn.style.background = "#555";
                btn.style.color = "#fff";
                status.innerText = "GPSè¨˜éŒ²ä¸­...";
                // æœ¬æ¥ã¯ã“ã“ã§GPSè¿½è·¡ã‚’é–‹å§‹
            } else {
                isRecording = false;
                btn.innerText = "ãƒ«ãƒ¼ãƒˆè¨˜éŒ²é–‹å§‹";
                btn.style.background = "#ffcc00";
                btn.style.color = "#000";
                status.innerText = "ä¿å­˜å®Œäº†";
            }
        }

        // --- éŸ³å£°å…¥åŠ›æ©Ÿèƒ½ ---
        function startVoice() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'ja-JP';
            const status = document.getElementById('status');
            const memoText = document.getElementById('memoText');

            recognition.onstart = () => {
                status.innerText = "èã„ã¦ã„ã¾ã™...";
                document.getElementById('voiceBtn').innerText = "èªè­˜ä¸­...";
            };

            recognition.onresult = (event) => {
                const text = event.results[0][0].transcript;
                memoText.value = text;
                status.innerText = "éŸ³å£°èªè­˜å®Œäº†";
            };

            recognition.onend = () => {
                document.getElementById('voiceBtn').innerText = "ğŸ¤ å£°ã§ãƒ¡ãƒ¢ã‚’å…¥ã‚Œã‚‹";
            };

            recognition.start();
        }

        // --- åœ°ç‚¹ä¿å­˜ ---
        function saveMemo() {
            const text = document.getElementById('memoText').value;
            if(!text) return alert("ãƒ¡ãƒ¢ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
            
            const log = document.getElementById('log');
            const now = new Date().toLocaleTimeString();
            log.innerHTML += `<div>[${now}] ${text}</div>`;
            
            document.getElementById('memoText').value = "";
            document.getElementById('status').innerText = "åœ°ç‚¹ã‚’ä¿å­˜ã—ã¾ã—ãŸ";
        }
    </script>
</body>
</html>